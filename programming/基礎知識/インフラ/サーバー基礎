#サーバー基礎

## サーバーとは

### **サーバーの種類**

サーバーが提供するサービスには様々なものがあります。 よく知られているサーバーの種類として以下のようなものがあります。

**Webサーバー**

HTMLやCSS、画像ファイルなどのWebコンテンツを配信するサーバー。あらかじめ保存しているコンテンツしか返さない。

例

---

Apache

---

Nginx

---

IIS

---

**アプリケーションサーバー**
JavaやRubyで書かれたプログラムを実行して必要な処理を行うサーバー。動的にHTMLなどのコンテンツを作成しクライアントに返す。

例

---

Tomcat

---

Unicorn

---

**メールサーバー**

メールの送受信サービスを提供するサーバー

例

---

Postfix

---

Exim

---

データベースサーバー

データベースの管理や操作を行うサーバー

例

---

Oracle

---

MySQL

---

PostgreSQL

---

### アプリケーションサーバー基礎

### アプリケーションサーバーとは

アプリケーションサーバー（APサーバー）は、 Webアプリケーションを実行するためのプログラムです。RailsなどのWebアプリケーションを実行し、ユーザーからのリクエストを動的に処理します。動的な処理とは、その時の状況によって異なる処理を行うことです。

また、通常はユーザーからのリクエストを直接受け取るのではなく、前面にWebサーバーを配置します。この時、Webサーバーでは静的なリクエストを処理し、Webサーバーでは処理できない動的なリクエストの処理をAPサーバーに依頼します。

例: WebサーバーとAPサーバーの連携

!https://runteq-infra-introduction-images.s3-ap-northeast-1.amazonaws.com/02/web_and_ap.png

### **2-2-2 アプリケーションサーバーの処理の流れ**

ここではRailsを例にAPサーバーの処理の流れを詳しくみていきましょう。

!https://runteq-infra-introduction-images.s3-ap-northeast-1.amazonaws.com/02/web_ap_db.png

**①ユーザーからのリクエスト**

ユーザーはブラウザを通してWebサーバーにリクエストを送ります（GET /current_user/books）

**②Webサーバーは動的なリクエストを処理できないのでAPサーバーに処理を依頼する**

**③APサーバーはリクエスト中のクッキーから現在のユーザーを取得し、そのユーザーに紐づくbook一覧のデータ取得をDBサーバーにリクエストする**

**④DBサーバーはリクエストに応じたデータをAPサーバーに返す**

**⑤APサーバーは取得したbook一覧を元にHTMLを生成し（この時にerbなどのテンプレートからHTMLが作られます）、Webサーバーに返す。**

**⑥Webサーバーがユーザーにレスポンスを返す**

この例で書いているように、APサーバーは単独で機能するのではなく、WebサーバーやDBサーバーと連携して動作することが多いです。

## データベースサーバー基礎

### データベースサーバーとは

Webアプリケーションに蓄積されるデータはデータベースに格納されますが、そのDBを管理するシステムをDBMS(データベースマネジメントシステム)といい、DBMSを動かすサーバーのことをデータベースサーバーといいます。また、DBMSのこともまとめてDBサーバーと呼ぶこともあります。

実はDBサーバーがなくてもAPサーバー上に保存用のファイル(メモ帳などで作成したテキストファイル)を作成しそれを読み書きすればデータを蓄積することができます。

しかし、DBサーバーは「高速なデータの読み書き」や「複数リクエストのトランザクション」「高い耐障害性」など、データ管理に特化した機能や性能を持っているので、業務ではDBサーバーを使うのが普通です。

### **2-3-2 DBMSの種類**

DBにはさまざまな種類があり、テーブル間の関係性を扱うのが得意なリレーショナルデータベース（RDB）や大規模データの処理が得意なNoSQLなどといったものがあります。

さらにそれぞれのDBの中でも複数のDBMSが提供されており、性能やサポートの有無に違いがあるため、アプリケーションや予算に合わせたシステムを選択する必要があります。

例えばRDBには以下のようなDBMSが存在しています（一例）。

主なRDB

---

MySQL

---

PostgreSQL

---

Oracle

---

SQL Server

---

SQLite

---

### **2-3-3 APサーバーとDBサーバーの連携**

DBサーバーに接続するには接続情報が必要になります。

通常必要となるのは以下のような情報です。

| 要素名 | 説明 |
| --- | --- |
| ユーザー | 操作権限が付与されたユーザー。ユーザーにより許可されている範囲（アクセスできるテーブル）や操作（SELECTやUPDATEなど）が異なる。 |
| パスワード | ユーザーに紐づけられたパスワード |
| ホスト | コンピューターを識別するための情報IPアドレスやドメインなどで識別する |
| ポート | 接続先のポート。省略した場合はデフォルトのポートが使われる（デフォルトのポートはDBMS毎に違います） |
| データベース名 | 作成したDB名 |

Railsでは`config/database.yml`にこれらの接続情報や設定情報を記載します。

また、DBとの接続にはクライアントソフトを使うのが一般的です。

Railsにおいても各種DBMSに対応したクライアントソフトがgemとして提供されており、それらを使ってDBと連携します。

---