## Active Storage

Active Storageは、Ruby on Railsアプリケーションでファイルアップロードを扱うためのフレームワークです。Rails 5.2で導入されて以降、Railsアプリケーション内で画像や動画、ドキュメントなどのファイルを簡単にアップロードし、保存するための標準的な方法として広く使われています。

### **主な機能**

- **クラウドストレージサービスとの統合**: Active Storageは、Amazon S3、Google Cloud Storage、Microsoft Azure Storageなど、複数のクラウドストレージサービスに対応しています。ローカル環境では、ファイルをディスク上に保存します。
- **ダイレクトアップロード**: ユーザーがアップロードする大きなファイルを直接クラウドストレージにアップロードできます。これにより、アプリケーションサーバーへの負荷を軽減し、ユーザー体験を向上させることができます。
- **画像変換**: ImageMagickを利用して、アップロードされた画像のリサイズや形式変換を行うことができます。これにより、Webページでの表示最適化やサムネイル作成を簡単に実装できます。
- **セキュアなファイルへのアクセス**: Active Storageは、アップロードされたファイルへのアクセス制御を提供します。URLを生成してファイルにアクセスする際、必要に応じて認証や期限設定を行うことができます。

### **使用方法の基本**

Active Storageを使用するには、まずRailsアプリケーションにActive Storageをセットアップする必要があります。これには、Active Storageのマイグレーションを実行して必要なテーブルをデータベースに追加し、使用するストレージサービスの設定を**`storage.yml`**に記述するというステップが含まれます。

モデルでファイルアップロードを扱いたい場合は、そのモデルに**`has_one_attached`**や**`has_many_attached`**マクロを使用してアタッチメントを定義します。これにより、そのモデルのインスタンスに対してファイルを添付したり、添付ファイルにアクセスしたりすることができるようになります。

```ruby

class User < ApplicationRecord
  has_one_attached :avatar
end

```

ファイルのアップロード、表示、リンク生成などは、Railsのビュー、コントローラー、ヘルパーメソッドを通じて行うことができます。

### **まとめ**

Active Storageは、Railsアプリケーションにおけるファイルアップロードと管理を簡単かつ効率的にするための強力なツールです。その柔軟性とクラウドサービスとの統合機能により、開発者はファイルストレージの複雑さを抽象化し、アプリケーションの開発に集中できます。

!https://static.zenn.studio/images/copy-icon.svg